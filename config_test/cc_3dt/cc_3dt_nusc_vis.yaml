!!python/object:ml_collections.config_dict.config_dict.ConfigDict
_convert_dict: true
_fields:
  benchmark: false
  callbacks:
  - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.callbacks.logging.LoggingCallback
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          epoch_based: true
          refresh_rate: 50
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.callbacks.checkpoint.CheckpointCallback
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          checkpoint_period: 1
          epoch_based: true
          save_prefix: vis4d-workspace/cc_3dt_nusc_vis/2023-07-27_02-22-32
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.callbacks.visualizer.VisualizerCallback
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          save_prefix: vis4d-workspace/cc_3dt_nusc_vis/2023-07-27_02-22-32
          test_connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.engine.connectors.multi_sensor.MultiSensorCallbackConnector
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      boxes3d: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: boxes_3d
                          source: prediction
                        _locked: false
                        _type_safe: true
                      class_ids: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: class_ids
                          source: prediction
                        _locked: false
                        _type_safe: true
                      extrinsics: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: extrinsics
                          sensors:
                          - CAM_FRONT
                          - CAM_FRONT_LEFT
                          - CAM_FRONT_RIGHT
                          - CAM_BACK
                          - CAM_BACK_LEFT
                          - CAM_BACK_RIGHT
                          source: data
                        _locked: false
                        _type_safe: true
                      image_names: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: sample_names
                          sensors:
                          - CAM_FRONT
                          - CAM_FRONT_LEFT
                          - CAM_FRONT_RIGHT
                          - CAM_BACK
                          - CAM_BACK_LEFT
                          - CAM_BACK_RIGHT
                          source: data
                        _locked: false
                        _type_safe: true
                      images: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: original_images
                          sensors:
                          - CAM_FRONT
                          - CAM_FRONT_LEFT
                          - CAM_FRONT_RIGHT
                          - CAM_BACK
                          - CAM_BACK_LEFT
                          - CAM_BACK_RIGHT
                          source: data
                        _locked: false
                        _type_safe: true
                      intrinsics: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: intrinsics
                          sensors:
                          - CAM_FRONT
                          - CAM_FRONT_LEFT
                          - CAM_FRONT_RIGHT
                          - CAM_BACK
                          - CAM_BACK_LEFT
                          - CAM_BACK_RIGHT
                          source: data
                        _locked: false
                        _type_safe: true
                      scores: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: scores_3d
                          source: prediction
                        _locked: false
                        _type_safe: true
                      sequence_names: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: sequence_names
                          source: data
                        _locked: false
                        _type_safe: true
                      track_ids: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: track_ids
                          source: prediction
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
          visualizer: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.vis.image.bbox3d_visualizer.MultiCameraBBox3DVisualizer
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  camera_near_clip: 0.15
                  cameras:
                  - CAM_FRONT
                  - CAM_FRONT_LEFT
                  - CAM_FRONT_RIGHT
                  - CAM_BACK
                  - CAM_BACK_LEFT
                  - CAM_BACK_RIGHT
                  cat_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      barrier: 9
                      bicycle: 0
                      bus: 3
                      car: 4
                      construction_vehicle: 7
                      motorcycle: 1
                      pedestrian: 2
                      traffic_cone: 8
                      trailer: 5
                      truck: 6
                    _locked: false
                    _type_safe: true
                  vis_freq: 1
                  width: 2
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.callbacks.visualizer.VisualizerCallback
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          save_prefix: vis4d-workspace/cc_3dt_nusc_vis/2023-07-27_02-22-32
          test_connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.engine.connectors.multi_sensor.MultiSensorCallbackConnector
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      boxes3d: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: boxes_3d
                          source: prediction
                        _locked: false
                        _type_safe: true
                      extrinsics: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: extrinsics
                          sensors:
                          - LIDAR_TOP
                          source: data
                        _locked: false
                        _type_safe: true
                      sample_names: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: sample_names
                          sensors:
                          - LIDAR_TOP
                          source: data
                        _locked: false
                        _type_safe: true
                      sequence_names: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: sequence_names
                          source: data
                        _locked: false
                        _type_safe: true
                      track_ids: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          key: track_ids
                          source: prediction
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
          visualizer: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.vis.image.bev_visualizer.BEVBBox3DVisualizer
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  vis_freq: 1
                  width: 2
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  data: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      test_dataloader: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          class_path: vis4d.data.loader.build_inference_dataloaders
          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              batchprocess_fn: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  class_path: vis4d.data.transforms.base.compose
                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      transforms:
                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.pad.PadImages
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              sensors:
                              - CAM_FRONT
                              - CAM_FRONT_LEFT
                              - CAM_FRONT_RIGHT
                              - CAM_BACK
                              - CAM_BACK_LEFT
                              - CAM_BACK_RIGHT
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.normalize.NormalizeImages
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              sensors:
                              - CAM_FRONT
                              - CAM_FRONT_LEFT
                              - CAM_FRONT_RIGHT
                              - CAM_BACK
                              - CAM_BACK_LEFT
                              - CAM_BACK_RIGHT
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.to_tensor.ToTensor
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              sensors:
                              - LIDAR_TOP
                              - CAM_FRONT
                              - CAM_FRONT_LEFT
                              - CAM_FRONT_RIGHT
                              - CAM_BACK
                              - CAM_BACK_LEFT
                              - CAM_BACK_RIGHT
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
              collate_fn: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  class_path: vis4d.config.config_dict.DelayedInstantiator
                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      instantiable: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          _class_path: vis4d.data.loader.multi_sensor_collate
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
              collate_keys: !!python/tuple
              - seg_masks
              - extrinsics
              - intrinsics
              - depth_maps
              - optical_flows
              - categories
              datasets: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  class_path: vis4d.data.data_pipe.DataPipe
                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      datasets: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.datasets.nuscenes.NuScenes
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              cache_as_binary: true
                              cached_file_path: data/nuscenes/val.pkl
                              data_backend: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.io.hdf5.HDF5Backend
                                _locked: false
                                _type_safe: true
                              data_root: data/nuscenes
                              keys_to_load: !!python/tuple
                              - images
                              - original_images
                              - boxes3d
                              skip_empty_samples: false
                              split: val
                              version: v1.0-trainval
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                      preprocess_fn: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.base.compose
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              transforms:
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.resize.GenResizeParameters
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      keep_ratio: true
                                      sensors:
                                      - CAM_FRONT
                                      - CAM_FRONT_LEFT
                                      - CAM_FRONT_RIGHT
                                      - CAM_BACK
                                      - CAM_BACK_LEFT
                                      - CAM_BACK_RIGHT
                                      shape: !!python/tuple
                                      - 900
                                      - 1600
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.resize.ResizeImages
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      sensors:
                                      - CAM_FRONT
                                      - CAM_FRONT_LEFT
                                      - CAM_FRONT_RIGHT
                                      - CAM_BACK
                                      - CAM_BACK_LEFT
                                      - CAM_BACK_RIGHT
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.resize.ResizeIntrinsics
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      sensors:
                                      - CAM_FRONT
                                      - CAM_FRONT_LEFT
                                      - CAM_FRONT_RIGHT
                                      - CAM_BACK
                                      - CAM_BACK_LEFT
                                      - CAM_BACK_RIGHT
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
              samples_per_gpu: 1
              sensors:
              - LIDAR_TOP
              - CAM_FRONT
              - CAM_FRONT_LEFT
              - CAM_FRONT_RIGHT
              - CAM_BACK
              - CAM_BACK_LEFT
              - CAM_BACK_RIGHT
              video_based_inference: true
              workers_per_gpu: 1
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
      train_dataloader: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          class_path: vis4d.data.loader.build_train_dataloader
          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              batchprocess_fn: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  class_path: vis4d.data.transforms.base.compose
                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      transforms:
                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.pad.PadImages
                        _locked: false
                        _type_safe: true
                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.normalize.NormalizeImages
                        _locked: false
                        _type_safe: true
                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.to_tensor.ToTensor
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
              collate_fn: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  class_path: vis4d.config.config_dict.DelayedInstantiator
                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      instantiable: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          _class_path: vis4d.data.loader.default_collate
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
              collate_keys: !!python/tuple
              - seg_masks
              - extrinsics
              - intrinsics
              - depth_maps
              - optical_flows
              - categories
              dataset: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  class_path: vis4d.data.data_pipe.DataPipe
                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      datasets: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.reference.MultiViewDataset
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              dataset: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.datasets.nuscenes_mono.NuScenesMono
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      cache_as_binary: true
                                      cached_file_path: data/nuscenes/mono_train.pkl
                                      data_backend: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                        _convert_dict: true
                                        _fields:
                                          class_path: vis4d.data.io.hdf5.HDF5Backend
                                        _locked: false
                                        _type_safe: true
                                      data_root: data/nuscenes
                                      keys_to_load: !!python/tuple
                                      - images
                                      - boxes2d
                                      - boxes3d
                                      skip_empty_samples: true
                                      split: train
                                      version: v1.0-trainval
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                              sampler: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.reference.UniformViewSampler
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      num_ref_samples: 1
                                      scope: 2
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                      preprocess_fn: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          class_path: vis4d.data.transforms.base.compose
                          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                            _convert_dict: true
                            _fields:
                              transforms:
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.resize.GenResizeParameters
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      keep_ratio: true
                                      shape: !!python/tuple
                                      - 900
                                      - 1600
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.resize.ResizeImages
                                _locked: false
                                _type_safe: true
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.resize.ResizeBoxes2D
                                _locked: false
                                _type_safe: true
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.base.RandomApply
                                  init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                    _convert_dict: true
                                    _fields:
                                      probability: 0.5
                                      transforms:
                                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                        _convert_dict: true
                                        _fields:
                                          class_path: vis4d.data.transforms.flip.FlipImages
                                        _locked: false
                                        _type_safe: true
                                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                        _convert_dict: true
                                        _fields:
                                          class_path: vis4d.data.transforms.flip.FlipIntrinsics
                                        _locked: false
                                        _type_safe: true
                                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                        _convert_dict: true
                                        _fields:
                                          class_path: vis4d.data.transforms.flip.FlipBoxes2D
                                        _locked: false
                                        _type_safe: true
                                      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                        _convert_dict: true
                                        _fields:
                                          class_path: vis4d.data.transforms.flip.FlipBoxes3D
                                        _locked: false
                                        _type_safe: true
                                    _locked: false
                                    _type_safe: true
                                _locked: false
                                _type_safe: true
                              - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                _convert_dict: true
                                _fields:
                                  class_path: vis4d.data.transforms.post_process.PostProcessBoxes2D
                                _locked: false
                                _type_safe: true
                            _locked: false
                            _type_safe: true
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
              pin_memory: true
              samples_per_gpu: 4
              sensors: null
              shuffle: true
              workers_per_gpu: 4
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  experiment_name: cc_3dt_nusc_vis
  log_every_n_steps: 50
  loss: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.loss_module.LossModule
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          losses:
          - connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.engine.connectors.base.LossConnector
                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                  _convert_dict: true
                  _fields:
                    key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        cls_outs: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.rpn.cls
                            source: prediction
                          _locked: false
                          _type_safe: true
                        images_hw: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.key_images_hw
                            source: prediction
                          _locked: false
                          _type_safe: true
                        reg_outs: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.rpn.box
                            source: prediction
                          _locked: false
                          _type_safe: true
                        target_boxes: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.key_target_boxes
                            source: prediction
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                  _locked: false
                  _type_safe: true
              _locked: false
              _type_safe: true
            loss: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.op.detect.rpn.RPNLoss
                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                  _convert_dict: true
                  _fields:
                    anchor_generator: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        class_path: vis4d.op.box.anchor.anchor_generator.AnchorGenerator
                        init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            ratios:
                            - 0.25
                            - 0.5
                            - 1.0
                            - 2.0
                            - 4.0
                            scales:
                            - 4
                            - 8
                            strides:
                            - 4
                            - 8
                            - 16
                            - 32
                            - 64
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                    box_encoder: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        class_path: vis4d.op.box.encoder.delta_xywh.DeltaXYWHBBoxEncoder
                        init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            target_means: !!python/tuple
                            - 0.0
                            - 0.0
                            - 0.0
                            - 0.0
                            target_stds: !!python/tuple
                            - 1.0
                            - 1.0
                            - 1.0
                            - 1.0
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                    loss_bbox: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        class_path: vis4d.config.config_dict.DelayedInstantiator
                        init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            instantiable: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                              _convert_dict: true
                              _fields:
                                _class_path: vis4d.op.loss.common.smooth_l1_loss
                                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                  _convert_dict: true
                                  _fields:
                                    beta: 0.1111111111111111
                                  _locked: false
                                  _type_safe: true
                              _locked: false
                              _type_safe: true
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                  _locked: false
                  _type_safe: true
              _locked: false
              _type_safe: true
          - connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.engine.connectors.base.LossConnector
                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                  _convert_dict: true
                  _fields:
                    key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        boxes: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.sampled_proposals.boxes
                            source: prediction
                          _locked: false
                          _type_safe: true
                        boxes_mask: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.sampled_targets.labels
                            source: prediction
                          _locked: false
                          _type_safe: true
                        class_outs: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.roi.cls_score
                            source: prediction
                          _locked: false
                          _type_safe: true
                        regression_outs: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.roi.bbox_pred
                            source: prediction
                          _locked: false
                          _type_safe: true
                        target_boxes: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.sampled_targets.boxes
                            source: prediction
                          _locked: false
                          _type_safe: true
                        target_classes: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.detector_out.sampled_targets.classes
                            source: prediction
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                  _locked: false
                  _type_safe: true
              _locked: false
              _type_safe: true
            loss: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.op.detect.rcnn.RCNNLoss
                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                  _convert_dict: true
                  _fields:
                    box_encoder: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        class_path: vis4d.op.box.encoder.delta_xywh.DeltaXYWHBBoxEncoder
                        init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            target_means: !!python/tuple
                            - 0.0
                            - 0.0
                            - 0.0
                            - 0.0
                            target_stds: !!python/tuple
                            - 0.1
                            - 0.1
                            - 0.2
                            - 0.2
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                    loss_bbox: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        class_path: vis4d.config.config_dict.DelayedInstantiator
                        init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            instantiable: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                              _convert_dict: true
                              _fields:
                                _class_path: vis4d.op.loss.common.smooth_l1_loss
                                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                                  _convert_dict: true
                                  _fields:
                                    beta: 0.1111111111111111
                                  _locked: false
                                  _type_safe: true
                              _locked: false
                              _type_safe: true
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                    num_classes: 10
                  _locked: false
                  _type_safe: true
              _locked: false
              _type_safe: true
            weight: 5.0
          - connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.engine.connectors.base.LossConnector
                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                  _convert_dict: true
                  _fields:
                    key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        key_embeddings: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.key_embeddings
                            source: prediction
                          _locked: false
                          _type_safe: true
                        key_track_ids: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.key_track_ids
                            source: prediction
                          _locked: false
                          _type_safe: true
                        ref_embeddings: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.ref_embeddings
                            source: prediction
                          _locked: false
                          _type_safe: true
                        ref_track_ids: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: qdtrack_out.ref_track_ids
                            source: prediction
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                  _locked: false
                  _type_safe: true
              _locked: false
              _type_safe: true
            loss: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.op.track.qdtrack.QDTrackInstanceSimilarityLoss
              _locked: false
              _type_safe: true
          - connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.engine.connectors.base.LossConnector
                init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                  _convert_dict: true
                  _fields:
                    key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                      _convert_dict: true
                      _fields:
                        labels: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: detector_3d_labels
                            source: prediction
                          _locked: false
                          _type_safe: true
                        pred: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: detector_3d_out
                            source: prediction
                          _locked: false
                          _type_safe: true
                        target: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                          _convert_dict: true
                          _fields:
                            key: detector_3d_target
                            source: prediction
                          _locked: false
                          _type_safe: true
                      _locked: false
                      _type_safe: true
                  _locked: false
                  _type_safe: true
              _locked: false
              _type_safe: true
            loss: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
              _convert_dict: true
              _fields:
                class_path: vis4d.op.detect3d.qd_3dt.Box3DUncertaintyLoss
              _locked: false
              _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  model: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.model.track3d.cc_3dt.FasterRCNNCC3DT
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          basemodel: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.op.base.resnet.ResNet
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  pretrained: true
                  resnet_name: resnet50
                  trainable_layers: 3
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
          faster_rcnn_head: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.op.detect.faster_rcnn.FasterRCNNHead
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  anchor_generator: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      class_path: vis4d.op.box.anchor.anchor_generator.AnchorGenerator
                      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          ratios:
                          - 0.25
                          - 0.5
                          - 1.0
                          - 2.0
                          - 4.0
                          scales:
                          - 4
                          - 8
                          strides:
                          - 4
                          - 8
                          - 16
                          - 32
                          - 64
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                  num_classes: 10
                  roi_head: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                    _convert_dict: true
                    _fields:
                      class_path: vis4d.op.detect.rcnn.RCNNHead
                      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                        _convert_dict: true
                        _fields:
                          num_classes: 10
                          num_shared_convs: 4
                        _locked: false
                        _type_safe: true
                    _locked: false
                    _type_safe: true
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
          num_classes: 10
          pure_det: false
          track_graph: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: vis4d.state.track3d.cc_3dt.CC3DTrackGraph
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  fps: 2
                  lstm_model: null
                  motion_model: KF3D
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  optimizers:
  - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      lr_schedulers:
      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          begin: 0
          end: 1000
          epoch_based: false
          scheduler: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: torch.optim.lr_scheduler.LinearLR
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  start_factor: 0.1
                  total_iters: 1000
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
      - !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          begin: 0
          end: -1
          epoch_based: true
          scheduler: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              class_path: torch.optim.lr_scheduler.MultiStepLR
              init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  gamma: 0.1
                  milestones:
                  - 8
                  - 11
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
      optimizer: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          class_path: torch.optim.sgd.SGD
          init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              lr: 0.01
              momentum: 0.9
              weight_decay: 0.0001
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
      param_groups:
      - custom_keys:
        - faster_rcnn_head.rpn_head.rpn_cls.weight
        - faster_rcnn_head.rpn_head.rpn_box.weight
        - faster_rcnn_head.roi_head.fc_cls.weight
        - faster_rcnn_head.roi_head.fc_reg.weight
        - bbox_3d_head.dep_convs.0.weight
        - bbox_3d_head.dep_convs.1.weight
        - bbox_3d_head.dep_convs.2.weight
        - bbox_3d_head.dep_convs.3.weight
        - bbox_3d_head.dim_convs.0.weight
        - bbox_3d_head.dim_convs.1.weight
        - bbox_3d_head.dim_convs.2.weight
        - bbox_3d_head.dim_convs.3.weight
        - bbox_3d_head.rot_convs.0.weightbbox_3d_head.rot_convs.1.weight
        - bbox_3d_head.rot_convs.2.weight
        - bbox_3d_head.rot_convs.3.weight
        - bbox_3d_head.cen_2d_convs.0.weight
        - bbox_3d_head.cen_2d_convs.1.weight
        - bbox_3d_head.cen_2d_convs.2.weight
        - bbox_3d_head.cen_2d_convs.3.weight
        - bbox_3d_head.fc_dep.weight
        - bbox_3d_head.fc_dep_uncer.weight
        - bbox_3d_head.fc_dim.weight
        - bbox_3d_head.fc_rot.weight
        - bbox_3d_head.fc_cen_2d.weight
        lr_mult: 10.0
    _locked: false
    _type_safe: true
  output_dir: vis4d-workspace/cc_3dt_nusc_vis/2023-07-27_02-22-32
  params: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      lr: 0.01
      num_epochs: 12
      samples_per_gpu: 4
      workers_per_gpu: 4
    _locked: false
    _type_safe: true
  pl_callbacks: []
  pl_trainer: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      accelerator: auto
      accumulate_grad_batches: 1
      barebones: false
      benchmark: false
      check_val_every_n_epoch: 1
      checkpoint_period: 1
      default_root_dir: null
      detect_anomaly: false
      deterministic: null
      enable_checkpointing: null
      enable_model_summary: null
      enable_progress_bar: false
      exp_name: cc_3dt_nusc_vis
      fast_dev_run: false
      find_unused_parameters: false
      gradient_clip_algorithm: null
      gradient_clip_val: 10
      inference_mode: true
      limit_predict_batches: null
      limit_test_batches: null
      limit_train_batches: null
      limit_val_batches: null
      log_every_n_steps: 50
      max_epochs: 12
      max_steps: -1
      max_time: null
      min_epochs: null
      min_steps: null
      num_nodes: 1
      num_sanity_val_steps: 0
      overfit_batches: 0.0
      plugins: null
      precision: 32-true
      profiler: null
      reload_dataloaders_every_n_epochs: 0
      save_top_k: 1
      sync_batchnorm: false
      use_distributed_sampler: false
      val_check_interval: null
      version: 2023-07-27_02-22-32
      wandb: false
      work_dir: vis4d-workspace
    _locked: false
    _type_safe: true
  seed: -1
  test_data_connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.connectors.multi_sensor.MultiSensorDataConnector
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              extrinsics: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  key: extrinsics
                  sensors:
                  - CAM_FRONT
                  - CAM_FRONT_LEFT
                  - CAM_FRONT_RIGHT
                  - CAM_BACK
                  - CAM_BACK_LEFT
                  - CAM_BACK_RIGHT
                  source: data
                _locked: false
                _type_safe: true
              frame_ids: frame_ids
              images: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  key: images
                  sensors:
                  - CAM_FRONT
                  - CAM_FRONT_LEFT
                  - CAM_FRONT_RIGHT
                  - CAM_BACK
                  - CAM_BACK_LEFT
                  - CAM_BACK_RIGHT
                  source: data
                _locked: false
                _type_safe: true
              images_hw: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  key: original_hw
                  sensors:
                  - CAM_FRONT
                  - CAM_FRONT_LEFT
                  - CAM_FRONT_RIGHT
                  - CAM_BACK
                  - CAM_BACK_LEFT
                  - CAM_BACK_RIGHT
                  source: data
                _locked: false
                _type_safe: true
              intrinsics: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
                _convert_dict: true
                _fields:
                  key: intrinsics
                  sensors:
                  - CAM_FRONT
                  - CAM_FRONT_LEFT
                  - CAM_FRONT_RIGHT
                  - CAM_BACK
                  - CAM_BACK_LEFT
                  - CAM_BACK_RIGHT
                  source: data
                _locked: false
                _type_safe: true
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  timestamp: 2023-07-27_02-22-32
  train_data_connector: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
    _convert_dict: true
    _fields:
      class_path: vis4d.engine.connectors.base.DataConnector
      init_args: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
        _convert_dict: true
        _fields:
          key_mapping: !!python/object:ml_collections.config_dict.config_dict.ConfigDict
            _convert_dict: true
            _fields:
              boxes2d: boxes2d
              boxes3d: boxes3d
              boxes3d_classes: boxes3d_classes
              boxes3d_track_ids: boxes3d_track_ids
              images: images
              images_hw: input_hw
              intrinsics: intrinsics
              keyframes: keyframes
            _locked: false
            _type_safe: true
        _locked: false
        _type_safe: true
    _locked: false
    _type_safe: true
  use_tf32: false
  version: 2023-07-27_02-22-32
  work_dir: vis4d-workspace
_locked: false
_type_safe: true
